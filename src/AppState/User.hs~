{-# LANGUAGE FlexibleContexts #-}
module AppState.User where

import Prelude hiding (lookup)
import Control.Monad.Reader
import Data.Map
import AppState.Model
import Model.User

askUsers :: (MonadReader AppState m) => m Users
askUsers = return . users =<< ask
 

listUsers :: (MonadReader AppState m) => m [String]
listUsers = liftM keys askUsers

authUser :: (MonadReader AppState m) => String -> String -> m (Maybe User)
authUser name pass = do
         user <- liftM (lookup name) askUsers
         case user of
              Just user' -> do
                   if password user' == pass
                      then return user
                      else return Nothing
              Nothing -> return Nothing
